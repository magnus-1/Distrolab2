@using community.Models @using community.Models.ViewModels.GroupViewModels @model community.Models.ViewModels.GroupViewModels.GroupIndexVM
@{ Layout = "~/Views/Shared/_Layout.cshtml"; }

<h2>Groups</h2>

<form id="createGroup" action="/Group/CreateGroup" method="GET" class="form-horizontal">
	<input name="groupTitle" type="text" class="form-control" />
	<button type="submit" class="btn btn-default">Create Group</button>
</form>


<table id="groupsTable" class="table">
	@foreach (var grp in Model.Groups) {
	<tr>`
		<td>
			@Html.DisplayFor(groupTitle => grp.Title)
		</td>
		<td>
				<button id="viewGroup" type="button" value="@grp.GroupId" class="btn btn-default">View Group</button>

		</td>
		<td>
				<button id="joinGroup" type="button" value="@grp.GroupId" class="btn btn-default">Join Group</button>

		</td>
	</tr>
	}

</table>

@section scripts {
<script>
$( "#createGroup" ).submit(function( event ) {
 
  event.preventDefault();
 

  var $form = $( this ),
    groupTitle2 = $form.find( "input[name='groupTitle']" ).val(),
    url = $form.attr( "action" );
 
  var posting = $.post( url, { groupTitle: groupTitle2} );
 
 // Put the results in a div
  posting.done(function( data ) {
    alert("I returnfunktionen!");
        var GroupId = data.groupId;
        var Title = data.title;
  
      
      $( "#groupsTable" ).append('<tr><td>'+Title+'</td><td><button id="viewGroup" type="button" value='+GroupId+' class="btn btn-default">View Group</button></td><td><button id="joinGroup" type="button" value='+GroupId+' class="btn btn-default">Join Group</button></td></tr>');

  });
});

$( "#viewGroup" ).click(function( event ) {
 
  event.preventDefault();
alert("I viewGroup!");

  var url = "/Group/ViewGroup";
  var gId = $("#viewGroup").val();
 // todo parse out values
  var posting = $.post( url, { groupId: gId} );
 
  // Put the results in a div
  //posting.done(function( data ) {
  //  var content = $( data ).find( "#content" );
  //  $( "#result" ).empty().append( content );
  //});
});

$( "#joinGroup" ).click(function( event ) {
 
  event.preventDefault();
 alert("I joinGroup!");

// todo parse out values
  
  var url ="/Group/JoinGroup";
  var gId = $("#joinGroup").val();
  var posting = $.post( url, { groupId: gId} );
 
  // Put the results in a div
  //posting.done(function( data ) {
  //  var content = $( data ).find( "#content" );
  //  $( "#result" ).empty().append( content );
  //});
});
</script> }